<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频播放页面</title>
    <script src="/js/jquery.js"></script>

    <!-- 引入Bootstrap CSS文件 -->
    <link rel="stylesheet" href="/bootstrap/bootstrap-5.3.0-alpha1-dist/css/bootstrap.min.css">

    <!-- 自定义样式 -->
    <style>
        body {
            font-family: 宋体;
        }

        .video-list {
            max-height: 300px;
            overflow-y: scroll;
        }

        .list-group::-webkit-scrollbar {
            width: 12px;
            background-color: rgb(0, 0, 0, 0);
        }

        .list-group::-webkit-scrollbar-thumb {
            background-color: rgba(81, 100, 209, .4);
        }

        .card {
            width: 100%;
            height: 100%;
            margin-top: 80px;
            background-image: linear-gradient(to left, rgba(81, 100, 209, .4), rgb(241, 207, 207, .6));
        }

        .embed-responsive-item {
            width: 100%;
            height: 100%;
        }

        .list-group {
            --bs-list-group-active-bg: rgba(81, 100, 209, .4);
            --bs-list-group-bg: rgba(0, 0, 0, 0);
        }
    </style>
</head>

<body>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
        }

        .container-fluid {
            height: 60px;
            background-image: linear-gradient(to left, rgba(81, 100, 209, .4), rgba(255, 255, 255));
        }

        .nav-link,
        .navbar-brand,
        .navbar-nav .nav-link.active,
        .nav-link.disabled {
            color: rgb(81, 100, 209);

        }

        .navbar-brand {
            font-size: 22px;
        }


        .fixed-top {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            z-index: 1030;

        }

        .bi-search {


            vertical-align: middle;

            margin-top: -2px;
        }

        .search-btn {
            float: right;
            width: 100px;
            height: 34px;
            background: rgb(81, 100, 209);
            border-radius: 18px;
            line-height: 36px;
            margin: 4px;
            cursor: pointer;
            text-align: center;

        }

        .search-btn:hover {
            opacity: .8;
        }

        form {
            margin-right: 40px;
        }

        .search-btn i {
            display: inline-block;
            vertical-align: middle;
            font-size: 16px;
            color: #fff;
            margin-left: 6px;

            align-items: center;


        }
    </style>
    <nav class="navbar navbar-expand-lg bg-body-tertiary fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="/bishe/moon.html">Linux操作系统学习平台</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/bishe/trun.html">首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/bishe/lesson.html">课程学习</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/bishe/jiueye.html">就业信息</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/bishe/person.html" id="person">个人信息</a>
                    </li>


                </ul>

                <form class="d-flex bi-search" role="search">
                    <input class="form-control me-2" type="search" placeholder="输入课程名" aria-label="Search">
                    <span class="search-btn" onclick="">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-search" viewBox="0 0 16 16" color="white">
                            <path
                                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                        </svg>
                        <i>搜索</i>
                    </span>
                </form>
                <video src="/bishe/video/mp4/linux.mp4"></video>
                <script>

                    function searchLesson(event) {
                        event.preventDefault(); // 防止表单默认提交

                        const form = document.getElementById("searchForm");
                        const keyword = form.querySelector('[name="keyword"]').value;

                        fetch(`http://localhost:5243/api/Search/search?keyword=${keyword}`)
                            .then(response => response.json())
                            .then(data => {
                                // 处理返回的数据...
                                const lessonNames = data.result.map(lesson => lesson.lessonName); // 获取所有课程名
                                if (lessonNames.length > 0) {
                                    alert(`找到 ${lessonNames.length} 个符合条件的课程：\n${lessonNames.join("\n")}`);
                                } else {
                                    alert("没有找到符合条件的课程。");
                                }
                            })
                            .catch(error => console.error(error));
                    }
                </script>

            </div>
        </div>
    </nav>

    <div class="container card">

        <!-- 视频区域（默认显示第一条视频） -->
        <div class="row">
            <div class="col-md-8">
                <h2 id="video-title">视频标题</h2>

                <div class="embed-responsive embed-responsive-16by9 card-body">
                    <video id="video-player" class="embed-responsive-item" src="videos/video-1.mp4" controls></video>
                </div>

                <p id="video-description">这里是视频描述信息，可以显示一些相关介绍和评价。</p>
            </div>
            <!-- 视频列表 -->
            <div class="col-md-4">
                <h3>视频列表</h3>
                <ul id="video-list" class="list-group video-list">
                    <li class="list-group-item" data-title="1.1 MOngoDB介绍"
                        data-description="本课程是 MongoDB 基础教程，介绍了 MongoDB 基本的集合操作、高级查询以及索引与聚合。"
                        data-src="\bishe\video\mp4\V20515-163534.mp4">1.1 MOngoDB介绍</li>
                    <li class="list-group-item" data-title="1.2MongoDB应用介绍"
                        data-description="本课程是 MongoDB 基础教程，介绍了 MongoDB 基本的集合操作、高级查询以及索引与聚合。"
                        data-src="videos/video-2.mp4"> 1.2MongoDB应用介绍</li>
                    <li class="list-group-item" data-title="视频3" data-description="这是视频3的描述信息。"
                        data-src="videos/video-3.mp4">1.3 MongoDB安装</li>
                    <li class="list-group-item" data-title="视频4" data-description="这是视频4的描述信息。"
                        data-src="videos/video-4.mp4">1.4 MongoDB特点</li>

                </ul>
            </div>
        </div>




    </div>

    <!-- 引入Bootstrap JS文件和自定义脚本 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 获取页面元素
        const videoList = document.getElementById('video-list');
        const videoPlayer = document.getElementById('video-player');
        const videoTitle = document.getElementById('video-title');
        const videoDescription = document.getElementById('video-description');

        // 播放第一个视频（在页面加载时）
        playVideo(videoList.firstElementChild);

        // 为视频列表项添加点击事件处理程序来切换视频播放器的内容
        videoList.addEventListener('click', function (event) {
            if (event.target && event.target.tagName === 'LI') {
                playVideo(event.target);
            }
        });

        // 播放指定列表项上的视频
        function playVideo(listItem) {
            // 更新视频源
            videoPlayer.src = listItem.dataset.src;

            // 更新视频标题和描述信息
            videoTitle.textContent = listItem.dataset.title;
            videoDescription.textContent = listItem.dataset.description;

            // 切换列表项的激活状态
            Array.from(videoList.children).forEach(child => child.classList.remove('active'));
            listItem.classList.add('active');
            // // 更新视频标题、描述和源
            // videoTitle.textContent = listItem.dataset.title;
            // videoDescription.textContent = listItem.dataset.description;
            // videoPlayer.src = listItem.dataset.src;

            // // 切换列表项的激活状态
            // Array.from(videoList.children).forEach(function (child) {
            //     child.classList.remove('active');
            // });
            // listItem.classList.add('active');
        }

        const urlParams = new URLSearchParams(window.location.search);
        const lessonId = urlParams.get('lessonId');

        fetch('http://localhost:5243/api/Chapters', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ Id: lessonId })
        })
            .then(response => response.json())
            .then(data => {
                if (data.isSuccess && data.result) {
            // 清空现有列表项
            videoList.innerHTML = '';

            data.result.forEach(chapter => {
                // 创建新的列表项元素
                const listItem = document.createElement('li');

                // 设置列表项的数据集属性
                listItem.dataset.title = chapter.chapterName;
                listItem.dataset.description = chapter.chapterContent ? chapter.chapterContent : "暂无描述";
                listItem.dataset.src = chapter.video || "";

                // 设置列表项的文本内容
                listItem.textContent = chapter.chapterName;

                // 将列表项添加到视频列表中
                videoList.appendChild(listItem);

                // 为新创建的列表项添加点击事件处理程序以切换视频
                listItem.addEventListener('click', function() {
                    if (!this.classList.contains('active')) {
                        // 切换激活状态
                        Array.from(videoList.children).forEach(child => child.classList.remove('active'));
                        this.classList.add('active');
                        
                        // 播放视频
                        playVideo(this);
                    }
                });
            });

            // 播放第一个视频
            playVideo(videoList.firstElementChild);
        } else {
            // 如果结果为null或isSuccess为false，则显示错误消息
            videoList.innerHTML = '<li class="list-group-item">暂无资源</li>';
        }
    })
    .catch(error => console.error('加载视频列表时出错：', error));
    </script>

</body>

</html>